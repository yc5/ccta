<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>電算中心實習生工作日誌格式轉換</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
        integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
    <style>
        textarea {
            width: 100%;
            resize: vertical;
        }

        button {
            width: 100%;
        }
    </style>
</head>

<body>
    <div class="container mt-3">
        <h1>電算中心實習生工作日誌格式轉換</h1>
        <form action="">
            <div class="row">
                <div class="col-md-8">
                    <div class="form-froup mb-3">
                        <label for="a">Evernote</label>
                        <textarea class="form-control" name="a" id="a" cols="30" rows="20">
當日編號：01
設備卡號：045678
聯絡時間：8:15
申請單位：航海系
申請人(分機)：汪先生(#7024)
服務性質： [] 到場處理    [x] 電話線上處理(含遠端處理)
服務類別： [] 硬體　 [] 軟體　 [x] 網路　 [] 郵件　 [] 重灌　 [] 中毒　 [] 無線　 [] 諮詢　 [] 印表機 　 [] 其他
處理結果： [x] 已完成　 [] 未完成
服務滿意度： [] 1  [] 2  [] 3  [] 4  [x] 5  
服務時間：10 分
作業系統：
問題簡述：
    1. Outlook 啟動時會顯示「資源已用盡」相關錯誤訊息，無法順利開啟。

解決方法：
    1. 使用者因近期遠端辦公，皆未關機。
    2. 請使用者嘗試重開機。
    3. 順利啟動。

FAQ選項： [] 已存在FAQ　 [] 已建立FAQ　 [x] 可能以後不會發生


當日編號：02
設備卡號：105897
聯絡時間：8:30
申請單位：寶可系
申請人(分機)：卡比獸
服務性質： [x] 到場處理    [] 電話線上處理(含遠端處理)
服務類別： [x] 硬體　 [] 軟體　 [] 網路　 [] 郵件　 [] 重灌　 [] 中毒　 [] 無線　 [] 諮詢　 [] 印表機 　 [] 其他
處理結果： [x] 已完成　 [] 未完成
服務滿意度： [] 1  [] 2  [] 3  [] 4  [x] 5  
服務時間：30 分
作業系統：
問題簡述：
    1. 使用者希望將大量聯絡人資料從 Excel 格式匯入到 Webmail。

解決方法：
    1. 以 Webmail 匯出 Microsoft Outlook 中文版 CSV 2013 格式範本。
    2. 在 Excel 將對應資料複製進去。
    3. 處理各欄位格式問題。
    4. 新增一通訊錄目錄。
    5. 匯入 CSV 檔。
    6. 因使用者希望能親自操作並學會，故花費較長時間教學。
    7. 使用者表示相當感謝。

FAQ選項： [] 已存在FAQ　 [] 已建立FAQ　 [x] 可能以後不會發生


當日編號：03
設備卡號：345872
聯絡時間：9:56
申請單位：語言中心
申請人(分機)：泡芙小姐(#3456)
服務性質： [x] 到場處理    [] 電話線上處理(含遠端處理)
服務類別： [] 硬體　 [] 軟體　 [] 網路　 [] 郵件　 [] 重灌　 [] 中毒　 [] 無線　 [] 諮詢　 [x] 印表機 　 [] 其他
處理結果： [x] 已完成　 [] 未完成
服務滿意度： [] 1  [] 2  [] 3  [] 4  [x] 5  
服務時間：12 分
作業系統：
問題簡述：
    1. 校園軟體無法授權。

解決方法：
    1. 到場與使用者確認問題並非無法透過 KMS 認證。
    2. 重新定義使用者問題為：無法登入校園授權軟體系統。
    3. 確認使用者可以登入校務資訊系統。
    4. 回報系統組(僅有系統組同仁有此權限，TA無法協助處理。)系統問題。
    5. 系統組回復，依據人事室資料，老師目前身分為「退休教師」，新身分「兼任老師」為111年2月才開始，故無法登入是正常的。
    6. 使用者表示指導學生實際截止日已延至10/31，目前仍有一指導研究生，而今已無法登入，系統登入原則與實際情形有落差，給人感覺不好。

FAQ選項： [] 已存在FAQ　 [] 已建立FAQ　 [x] 可能以後不會發生


當日編號：04
設備卡號：056941
聯絡時間：13:18
申請單位：主計室
申請人(分機)：魯夫先生(#5487)
服務性質： [] 到場處理    [x] 電話線上處理(含遠端處理)
服務類別： [] 硬體　 [] 軟體　 [] 網路　 [] 郵件　 [] 重灌　 [x] 中毒　 [] 無線　 [] 諮詢　 [] 印表機 　 [] 其他
處理結果： [x] 已完成　 [] 未完成
服務滿意度： [] 1  [] 2  [] 3  [] 4  [x] 5  
服務時間：120 分
作業系統：
問題簡述：
    1. 大宗郵件寄出後會收到收件人無法收件的郵件。

解決方法：
    1. 檢查大宗郵件帳戶設定。
    2. 帳號部份使用者多打了「@」後面的內容。
    3. 使用者未勾選「我的SMTP伺服器需要驗證」。
    4. 使用者未取消勾選「接收收件」。

FAQ選項： [] 已存在FAQ　 [] 已建立FAQ　 [x] 可能以後不會發生


當日編號：05
設備卡號：895020
聯絡時間：15:30
申請單位：研教組
申請人(分機)：陳老師
服務性質： [] 到場處理    [x] 電話線上處理(含遠端處理)
服務類別： [] 硬體　 [] 軟體　 [] 網路　 [x] 郵件　 [] 重灌　 [] 中毒　 [] 無線　 [] 諮詢　 [] 印表機 　 [] 其他
處理結果： [x] 已完成　 [] 未完成
服務滿意度： [] 1  [] 2  [] 3  [] 4  [x] 5  
服務時間：70 分
作業系統：
問題簡述：
    1. 畢業證書 Word 檔無法列印，其他 Word 檔可以。

解決方法：
    1. 將印表機暫時改為「列印至PDF」，跳出「找不到超明體」錯誤訊息。
    2. 將 PDF 印表機設定「依賴系統字型」取消勾選，即可列印成 PDF。
    3. 但將印表機調整回原印表機後，因為暫時找不到讓印表機不要依賴系統字型的設定，已經17:10，故交接。

FAQ選項： [] 已存在FAQ　 [] 已建立FAQ　 [x] 可能以後不會發生

當日編號：06
設備卡號：895020
聯絡時間：15:30
申請單位：研教組
申請人(分機)：董先生(#5487)
服務性質： [] 到場處理    [x] 電話線上處理(含遠端處理)
服務類別： [] 硬體　 [] 軟體　 [] 網路　 [] 郵件　 [] 重灌　 [] 中毒　 [] 無線　 [] 諮詢　 [] 印表機 　 [x] 其他
處理結果： [x] 已完成　 [] 未完成
服務滿意度： [] 1  [] 2  [] 3  [] 4  [x] 5  
服務時間：25 分
作業系統：
問題簡述：
    1. Office 2019 安裝後未啟用。

解決方法：
    1. 使用者有先移除內建 Office。
    2. 引導使用者將已下載之認證 bat 檔以系統管理員身分執行。
    3. 告知使用者 2019 版本版面顯示不會與 2016 有太大差異。

FAQ選項： [] 已存在FAQ　 [] 已建立FAQ　 [x] 可能以後不會發生

當日編號：07
設備卡號：895020
聯絡時間：15:30
申請單位：寶可系
申請人(分機)：皮卡丘
服務性質： [] 到場處理    [x] 電話線上處理(含遠端處理)
服務類別： [] 硬體　 [] 軟體　 [] 網路　 [] 郵件　 [] 重灌　 [] 中毒　 [] 無線　 [] 諮詢　 [x] 印表機 　 [] 其他
處理結果： [x] 已完成　 [] 未完成
服務滿意度： [] 1  [] 2  [] 3  [] 4  [x] 5  
服務時間：36 分
作業系統：
問題簡述：
    1. 因電腦運行速度慢，需要重灌。

解決方法：
    1. 清潔電腦內部灰塵。
    2. 將使用者資料移動至 D Disk。
    3. 因使用者硬碟索引格式較舊，無法使用既有 Windows 安裝隨身碟安裝。
    4. 使用 WinNTSetup 安裝 Windows 10 至 C Disk。

FAQ選項： [] 已存在FAQ　 [] 已建立FAQ　 [x] 可能以後不會發生

當日編號：08
設備卡號：845021
聯絡時間：15:30
申請單位：航海系
申請人(分機)：伊力薩貝羅二世
服務性質： [x] 到場處理    [] 電話線上處理(含遠端處理)
服務類別： [] 硬體　 [] 軟體　 [] 網路　 [] 郵件　 [] 重灌　 [] 中毒　 [x] 無線　 [] 諮詢　 [] 印表機 　 [] 其他
處理結果： [x] 已完成　 [] 未完成
服務滿意度： [] 1  [] 2  [] 3  [] 4  [x] 5  
服務時間：28 分
作業系統：
問題簡述：
    1. 無法正常使用政府電子採購網系統。

解決方法：
    1. 安裝 32 bit 版本 Java Environment。
    2. 執行該系統檢測工具。
    3. 檢測成功。
    4. 取消瀏覽器阻擋彈跳視窗。
    5. 成功使用。

FAQ選項： [] 已存在FAQ　 [] 已建立FAQ　 [x] 可能以後不會發生

當日編號：09
設備卡號：055789
聯絡時間：8:16
申請單位：航海系
申請人(分機)：汪先生(#7024)
服務性質： [x] 到場處理    [] 電話線上處理(含遠端處理)
服務類別： [] 硬體　 [] 軟體　 [x] 網路　 [] 郵件　 [] 重灌　 [] 中毒　 [] 無線　 [] 諮詢　 [] 印表機 　 [] 其他
處理結果： [x] 已完成　 [] 未完成
服務滿意度： [] 1  [] 2  [] 3  [] 4  [x] 5  
服務時間：22 分
作業系統：
問題簡述：
    1. Outlook 啟動時會顯示「資源已用盡」相關錯誤訊息，無法順利開啟。

解決方法：
    1. 使用者因近期遠端辦公，皆未關機。
    2. 請使用者嘗試重開機。
    3. 順利啟動。

FAQ選項： [] 已存在FAQ　 [] 已建立FAQ　 [x] 可能以後不會發生

當日編號：10
設備卡號：
聯絡時間：10:16
申請單位：航海系
申請人(分機)：汪先生(#7024)
服務性質： [x] 到場處理    [] 電話線上處理(含遠端處理)
服務類別： [] 硬體　 [] 軟體　 [x] 網路　 [] 郵件　 [] 重灌　 [] 中毒　 [] 無線　 [] 諮詢　 [] 印表機 　 [] 其他
處理結果： [x] 已完成　 [] 未完成
服務滿意度： [] 1  [] 2  [] 3  [] 4  [x] 5  
服務時間：22 分
作業系統：
問題簡述：
    1. 使用者希望將大量聯絡人資料從 Excel 格式匯入到 Webmail。

解決方法：
    1. 以 Webmail 匯出 Microsoft Outlook 中文版 CSV 2013 格式範本。
    2. 在 Excel 將對應資料複製進去。
    3. 處理各欄位格式問題。
    4. 新增一通訊錄目錄。
    5. 匯入 CSV 檔。
    6. 因使用者希望能親自操作並學會，故花費較長時間教學。
    7. 使用者表示相當感謝。

FAQ選項： [] 已存在FAQ　 [] 已建立FAQ　 [x] 可能以後不會發生
            </textarea>
                    </div>
                    <div class="form-froup mb-3">
                        <label for="a">Excel</label>
                        <textarea class="form-control" name="b" id="b" cols="30" rows="10"></textarea>
                    </div>
                </div>
                <div class="col-md-4">

                    <div class="form-froup mb-3">
                        <label for="name">TA</label>
                        <select class="form-control" id="name"></select>
                    </div>
                    <div class="form-froup mb-3">
                        <button class="btn btn-secondary mb-3" type="button" id="clearAndPaste">清除並貼上</button>
                        <button class="btn btn-secondary mb-3" type="button" id="clear">清除</button>
                        <button class="btn btn-secondary mb-3" type="button" id="select">全選</button>
                        <button class="btn btn-secondary mb-3" type="reset">重置範例</button>
                        <button class="btn btn-primary mb-3" type="submit">轉換</button>
                        <button class="btn btn-primary mb-3" type="button" id="copy">複製</button>
                    </div>
                    <div class="form-froup mb-3">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">提示訊息</h5>
                                <div class="card-text" id="msg">
                                    請先選擇 TA 名稱，並將 Evernote 內容貼上於文字方塊。
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </form>
    </div>

    <footer class="footer mt-auto py-3">
        <div class="container">
            <span class="text-muted">&copy; 2021 XSTAR STUDIO</span>
            <a href="https://github.com/yc5/ccta" target="_blank">GitHub</a>
        </div>
    </footer>

    <script>
        let taNames = ["以誠", "君桓", "亭臻", "凱麟", "奕嫣"]
        let data, times, departments, catgories, transfers, catgoryTitles, output, output2, tmpArray = [], tmpTotalTime
        window.onload = () => {
            /* insert ta names option into select */
            let dayToday = new Date().getDay()
            let itemSelect = document.createElement("option")
            if (dayToday < 5) {
                itemSelect.text = taNames[dayToday - 1]
                document.getElementById("name").appendChild(itemSelect)
                taNames.splice(dayToday - 1, 1)
            }
            taNames.forEach(e => {
                var itemSelect = document.createElement("option")
                itemSelect.text = e
                document.getElementById("name").appendChild(itemSelect)
            })
        }
        document.forms[0].addEventListener("submit", (e) => {
            e.preventDefault()

            try {
                times = document.forms[0].a.value.matchAll(/服務時間：\s*(\d+).+/g)
                departments = document.forms[0].a.value.matchAll(/申請單位：(.+)/g)
                types = document.forms[0].a.value.matchAll(/服務性質：[^x]+\[x\]\s([^\[\s]+)[^x]*\n/g)
                catgories = document.forms[0].a.value.matchAll(/服務類別：[^x]+\[x\]\s([^\[\s]+)[^x]*\n/g)
                transfers = document.forms[0].a.value.matchAll(/\d\.\s(.+\(僅有.+同仁有此權限，TA無法協助處理。\).+)/g)
                catgoryTitles = document.forms[0].a.value.match(/服務類別：.+\n/g)[0]
                catgoryTitles = catgoryTitles.replaceAll(/[服務類別：\s\tx]/g, "").split("[]")
                catgoryTitles.shift()

                /* transform matches iterators into array */
                tmpTotalTime = 0
                for (const i of times) {
                    tmpArray.push(parseInt(i[1]))
                    tmpTotalTime += parseInt(i[1])
                }
                times = tmpArray
                tmpArray = []

                for (const i of departments) {
                    tmpArray.push(i[1])
                }
                departments = tmpArray
                tmpArray = []

                for (const i of types) {
                    tmpArray.push(i[1])
                }
                types = tmpArray
                tmpArray = []

                for (const i of catgories) {
                    tmpArray.push(i[1])
                }
                catgories = tmpArray
                tmpArray = []

                for (const i of transfers) {
                    tmpArray.push(i[1])
                }
                transfers = tmpArray
                tmpArray = []

                /* create data object */
                data = {}
                for (let i = 0; i < departments.length; i++) {
                    data[departments[i]] = {}
                    catgories.forEach(e => {
                        data[departments[i]][e] = 0
                    })
                }
                for (let i = 0; i < times.length; i++) {
                    data[departments[i]][catgories[i]] += times[i]
                }
                console.log(data);

                /* print output */
                if (times.length >= 1
                    && times.length == departments.length
                    && departments.length == catgories.length) {
                    output = ""
                    output2 = ""
                    output += "---\n"
                    output += "#### "
                    output += new Date().toJSON().slice(5, 10).replace(/-/g, '/')
                    output += " AM PM\n"
                    output += "- TA：" + document.forms[0].name.value + "\n"
                    output += "- 防禦率(S/T)\n"
                    output += "    - 總服務案件數(T)：" + times.length + "\n"
                    output += "    - 自行解決案件數(S)：" + (times.length - transfers.length) + "\n"
                    output += "    - 轉介其他單位案件數(F=T-S)：" + transfers.length + "\n"
                    for (let i = 0; i < transfers.length; i++) {
                        output += "        - " + transfers[i] + "\n"
                    }
                    output += "- 總服務時間(mins.)：" + tmpTotalTime + "\n\n"
                    output += "|單位|總時間|"
                    for (let i = 0; i < catgoryTitles.length; i++) {
                        output += catgoryTitles[i] + "|";
                    }
                    output += "\n|:---:|:---:|"
                    for (let i = 0; i < catgoryTitles.length; i++) {
                        output += ":---:|"
                    }
                    output += "\n"
                    for (const dps in data) {
                        output += "| " + dps + " |"
                        tmpTotalTime = 0
                        for (const t in data[dps]) {
                            tmpTotalTime += data[dps][t]
                        }
                        output += "\t" + tmpTotalTime + "\t|"

                        for (let j = 0; j < catgoryTitles.length; j++) {
                            if (data[dps][catgoryTitles[j]]) {
                                output += "\t" + data[dps][catgoryTitles[j]] + "\t|"

                            } else {
                                output += "\t|"
                            }
                        }
                        output += "\n"
                    }
                    output += "\n"
                    output += "- 用戶申訴事項：無。\n"
                    output += "- 建議：無。\n\n"

                    for (let i = 0; i < times.length; i++) {
                        output2 += new Date().toJSON().slice(5, 10).replace(/-/g, '/') + "\t"
                        output2 += document.forms[0].name.value + "\t"
                        output2 += types[i] + "\t" + catgories[i] + "\t" + times[i] + "\t5\t" + departments[i] + "\t" + (i + 1)
                        output2 += "\n"
                    }

                    document.forms[0].a.value = output
                    document.forms[0].b.value = output2

                    document.querySelector("textarea").select();
                    document.getElementById("msg").innerText = "轉換完成。"
                } else {
                    throw "Wrong length of arrays."
                }
            } catch (error) {
                alert("Evernote 格式有誤。")
                console.log(error);
            }




            /* generation 1 - outdated */
            // document.forms[0].a.value = document.forms[0].a.value.replaceAll(/FAQ選項：.+\n/g, "---")
            // document.forms[0].a.value = document.forms[0].a.value.replaceAll(/服務滿意度：.+\n服務時間：.+\n/g, "")
            // document.forms[0].a.value = document.forms[0].a.value.replaceAll("[x]", "[✔]")

        })

        document.getElementById("copy").addEventListener("click", (e) => {
            document.querySelector("textarea").select();
            document.execCommand("copy");
            document.getElementById("msg").innerText = "已複製至剪貼簿！"
        })
        document.getElementById("clear").addEventListener("click", (e) => {
            document.forms[0].a.value = ""
        })
        document.getElementById("select").addEventListener("click", (e) => {
            document.querySelector("textarea").select();
        })
        document.getElementById("clearAndPaste").addEventListener("click", (e) => {
            console.log(!navigator.clipboard);
            if (!navigator.clipboard) {
                alert("瀏覽器不支援「navigator.clipboard」功能。")
            } else {
                if (!navigator.clipboard.readText) {
                    alert("瀏覽器不支援「貼上」功能。")
                } else {
                    navigator.clipboard.readText().then(clipText => {
                        document.forms[0].a.value = clipText
                    });
                }
            }
        })

        // document.querySelector("textarea").addEventListener("click", function () {
        //     this.select();
        //     document.getElementById("msg").innerText = "提示訊息：請貼上 Evernote 格式，並按下轉換。"
        // });

        // https://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array
        function shuffle(array) {
            let currentIndex = array.length, randomIndex;

            // While there remain elements to shuffle...
            while (currentIndex != 0) {

                // Pick a remaining element...
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;

                // And swap it with the current element.
                [array[currentIndex], array[randomIndex]] = [
                    array[randomIndex], array[currentIndex]];
            }

            return array;
        }
    </script>
</body>

</html>